## PHASE 0 – NỀN TẢNG KỸ THUẬT (BẮT BUỘC)

### 0.1 Backend foundation

* [x] Spring Boot 3 + Java 17
* [~] Cấu trúc module:

  * auth
  * user
  * file
  * course
  * learning
  * quiz
  * review
  * qna
  * admin/moderation
* [ ] BaseEntity:

  * id
  * is_active / is_deleted
  * created_date / updated_date
  * created_user / updated_user
* [x] AuditorAware (lấy user từ JWT)

### 0.2 Global conventions

* [x] Response chuẩn (`ResponseDto`)
* [ ] Error code enum
* [x] Validation + ExceptionHandler
* [~] Pagination + sorting chuẩn
* [~] Soft delete rule áp dụng toàn hệ thống

---

## PHASE 1 – FILE & STORAGE (MINIO – TRỌNG TÂM)

### 1.1 Storage architecture

* [x] MinIO bucket: `lms-files`
* [x] Folder convention:

  * `images/`
  * `videos/`
  * `other/`
* [x] Không dùng local storage

### 1.2 File lifecycle (rất quan trọng)

Trên bảng `uploaded_file`:

* [x] PENDING → READY → ATTACHED → (DELETED)
* Rule:

  * PENDING: presign PUT, chờ upload xong
  * READY: upload xong, chờ dùng
  * ATTACHED: đã gắn vào course/lesson
  * DELETED: abort hoặc xoá

### 1.3 File APIs (BE)

* [x] `POST /files/presign/put`
* [x] `POST /files/complete`
* [x] `POST /files/abort`
* [x] `GET /files/{id}/url`
* [x] `GET /files/meta/{id}`
* [~] Permission:

  * presign PUT → INSTRUCTOR / ADMIN
  * GET URL → tuỳ is_public + enrollment

### 1.4 File rules nghiệp vụ

* [x] Abort chỉ khi status ≠ ATTACHED
* [x] Attach chỉ khi status = READY
* [~] Không cho xoá file đang dùng
* [ ] Cron dọn PENDING quá hạn

---

## PHASE 2 – AUTH & RBAC

### 2.1 Auth

* [x] Login / Refresh / Logout
* [x] JWT Access Token (stateless)
* [x] Refresh token rotation (`refresh_token` table)
* [x] Multi-device support

### 2.2 RBAC

* [x] Role: ADMIN / INSTRUCTOR / STUDENT
* [ ] Permission:

  * COURSE_CREATE
  * COURSE_PUBLISH
  * COURSE_EDIT
  * COURSE_REVIEW

---

## PHASE 3 – CATALOG (BROWSE)

### 3.1 Category

* [x] CRUD category (admin)
* [~] Tree category (parent_id)
* [ ] Slug + SEO

### 3.2 Tag

* [x] CRUD tag
* [x] Gắn tag cho course (`course_tag`)

### 3.3 Public course listing

* [x] Search
* [x] Filter:

  * category
  * level
  * language
* [x] Sort:

  * newest
  * rating
  * popular

---

## PHASE 4 – COURSE AUTHORING (INSTRUCTOR)

> **Đây là chốt todo còn thiếu**

### 4.1 Course lifecycle

* [x] Create course (status = DRAFT)
* [x] Update landing page
* [x] Publish / Unpublish
* [x] Archive

### 4.2 Course landing page

* [x] Title / description
* [x] Level / language
* [x] Thumbnail (uploaded_file + ATTACHED)
* [x] Intro video (presign upload + ATTACHED)

### 4.3 Instructor management

* [x] course_instructor:

  * OWNER
  * CO_INSTRUCTOR
* [x] Revenue share (sau dùng cho payment)

---

## PHASE 5 – CURRICULUM & CONTENT

### 5.1 Section

* [x] CRUD `course_section`
* [x] Reorder section

### 5.2 Lesson

* [x] Lesson type:

  * VIDEO
  * ARTICLE
  * QUIZ
* [x] Video lesson:

  * upload video (MinIO)
  * duration
* [x] Article lesson:

  * content_text

### 5.3 Mapping course – lesson

* [x] `course_lesson`
* [x] Position
* [x] Preview  ai cung xem

### 5.4 Documents

* [x] Upload document (presign + attach READY file as DOCUMENT)
* [x] Gan course_document
* [x] Gan lesson_document

---

## PHASE 6 – LEARNING FLOW (STUDENT)

### 6.1 Enrollment

* [x] Free enroll (tạm thời)
* [x] enrollment status

### 6.2 Lesson access control

* [x] Preview  ai cung xem
* [x] Full lesson  ph?i enrolled
* [x] Check permission khi g?i file URL

### 6.3 Progress

* [x] completed
* [x] last_position_seconds
* [x] last_accessed_at

---

## PHASE 7 - QUIZ

* [x] Quiz CRUD
* [x] Question CRUD
* [x] Answer CRUD
* [x] Attempt:

  * start
  * submit
  * grade
* [x] Store result (`quiz_attempt`, `quiz_attempt_answer`)

---

## PHASE 8 – REVIEW & RATING

* [ ] Mỗi user 1 review / course
* [x] Moderation status
* [x] Update rating_avg / rating_count

---

## PHASE 9 - Q&A

* [x] Question theo course / lesson
* [x] Answer
* [x] Accept answer
* [x] Vote

---

## PHASE 10 – MODERATION / REPORT

* [ ] Report content
* [ ] Admin review queue
* [ ] Moderation action log

---

## PHASE 11 – COMMERCE (LÀM SAU)

* [ ] Pricing
* [ ] Order / order_item
* [ ] Payment integration
* [ ] Paid → create enrollment
* [ ] Refund

---

## PHASE 12 – NON-FUNCTIONAL (RẤT QUAN TRỌNG)

* [ ] Rate limit upload
* [ ] Virus scan (optional)
* [ ] Logging upload/download
* [ ] Analytics nhỏ:

  * document_view
* [ ] Backup MinIO + DB
